(function(){var a={dataPath:"data/",dataBest:"best.dat",dataSolutions:"solution.%n.dat",answer:[],$solutions:document.getElementById("solutions"),$answer:document.getElementById("answer"),$last:document.getElementById("last"),$next:document.getElementById("next"),$quiz:document.getElementById("quiz"),$formula:document.getElementById("formula"),$solution:document.getElementById("solution"),getName:function(b){return a.dataSolutions.replace(/%n/,(b-1)/50|0)},getLatex:function(a,c){return"$$"+a+"="+
c.replace(/([a-z])/g,"#$1").replace(/#t/g,"\\times").replace(/#s/g,"\\sqrt").replace(/#l/g,"\\left").replace(/#r/g,"\\right").replace(/#f/g,"\\frac").replace(/#x/g,"\\textstyle")+"$$"}},d=window.tchisla={getData:function(b,c,d){var e=new XMLHttpRequest;e.open("GET",a.dataPath+b,d);e.onload=function(){200<=e.status&&400>e.status&&(console.log("file load success",b),a[b]=e.responseText,c(a[b]))};e.send()},parseData:function(b){b.split(/[\n\r]+/).forEach(function(b){b.match(/^\d+,\d+,[^,]+,[^,]+$/)&&
(b=b.split(","),a.answer[b[0]]=a.answer[b[0]]||[],a.answer[b[0]][b[1]]=[b[2],b[3]])})},preparePad:function(){var b=a[a.dataBest].split(/[\n\r]+/);b.forEach(function(c,d){var e=document.createElement("tr"),f=document.createElement("td");f.setAttribute("class","row");f.innerText=d+1;e.appendChild(f);for(var g=0;8>=g;g++)f=document.createElement("td"),f.setAttribute("rel",d+1+"#"+(g+1)),f.innerText=parseInt(c[g],36),e.appendChild(f);a.maxY=b.length;a.$solutions.appendChild(e)})},showAnswer:function(b,
c){a.x=+c;a.y=+b;a.$answer.style.display="block";a.$quiz.innerText=b+"#"+c;a.$solution.innerText=b+"="+a.answer[b][c][0];MathJax&&(a.$formula.innerText=a.getLatex(b,a.answer[b][c][1]),MathJax.Hub.Queue(["Typeset",MathJax.Hub,a.$formula]))},render:function(){d.getData(a.dataBest,d.preparePad,!0);a.$solutions.addEventListener("click",function(b){if(b=b.target.getAttribute("rel")){var c=b.split("#");b=+c[0];c=+c[1];a[a.getName(b)]||d.getData(a.getName(b),d.parseData,!1);d.showAnswer(b,c)}});a.$answer.addEventListener("click",
function(b){"last"===b.target.id?(0===--a.x&&(a.x=9,a.y--),0>=a.y&&(a.x=1,a.y=1),d.showAnswer(a.y,a.x)):"next"===b.target.id?(10===++a.x&&(a.x=1,a.y++),a.y>a.maxY&&(a.x=9,a.y=a.maxY),d.showAnswer(a.y,a.x)):a.$answer.style.display="none"})}};d.render()})();
